Actually you can upload any file to the webserver. It makes you think it will always be a jpeg file because the extension always changes to .jpg after you upload it, but that's because the extension taken inside the makeRandomPathFromFilename finction isn't from the file you uploaded, but from the random .jpg filename generated by the end of the source code.

If you modify the random .jpg filename into a .php file before forwarding it to the webserver, then the file you upload will be executed as a php file. As such, you just need to upload a php that takes the password from the file with command like:

echo shell_exec('cat /etc/natas_webpass/natas13');

Then you get the password opening the file.

trbs5pCjCrkuSknBBKHhaBxq6Wm1j3LC

